- name: Persist state.json
  run: |
    git config user.name "github-actions"
    git config user.email "github-actions@github.com"

    if [ ! -f state.json ]; then
      echo "state.json absent : rien à sauvegarder."
      exit 0
    fi

    git add state.json

    if git diff --staged --quiet; then
      echo "state.json inchangé : rien à sauvegarder."
      exit 0
    fi

    git commit -m "Update HFR monitor state [skip ci]"
    git push
